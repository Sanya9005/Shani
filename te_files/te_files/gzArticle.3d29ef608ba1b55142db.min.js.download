webpackJsonp([0],{81:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(82),n=i(84),s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t||document.body,this.onAfterNextStoryTransition=this.onAfterNextStoryTransition.bind(this),this.photoViewer=!!this.hasPhotoViewerSupport()&&new n.a(this.el),this.nextStory=new r.a(this.el),this.el.addEventListener("gz.nextStory.afterTransitionNextStory",this.onAfterNextStoryTransition)}return s(e,[{key:"onAfterNextStoryTransition",value:function(){this.photoViewer.reinit()}},{key:"hasPhotoViewerSupport",value:function(){return Modernizr.dataset}}]),e}();t.default=o},82:function(e,t,i){"use strict";var r=i(83),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.storyContainer=document.querySelector(".site-content"),this.bodyEl=document.querySelector("body"),!document.documentMode){if(!this.el)throw new Error("Invalid element reference.");window.addEventListener("popstate",this),this.init()}}return n(e,[{key:"init",value:function(){this.currentStoryDiv=document.querySelector("#main"),this.currentWPAdminBar=document.querySelector("#wpadminbar"),this.nextStoryTease=document.querySelector(".tz-article-next__link"),this.navNextStoryLink=document.querySelector(".article-sticky-navbar__next-link"),this.nextStoryDocument,this.nextStoryDiv,this.nextStoryTease&&(window.addEventListener("scroll",this),this.nextStoryTease.addEventListener("click",this),this.navNextStoryLink.addEventListener("click",this))}},{key:"handleEvent",value:function(e){var t=this;switch(e.type){case"scroll":window.removeEventListener("scroll",this);new this.getNextStory(this.nextStoryTease.href).then(function(e){t.nextStoryDocument=e}).catch(function(e){console.error("Error",e)});break;case"click":if(e.metaKey||e.ctrlKey)return;e.preventDefault(),this.nextStoryTease.removeEventListener("click",this),this.navNextStoryLink.removeEventListener("click",this),this.transitionCurrentStory(this.nextStoryDocument);break;case"popstate":window.location.assign(e.target.location.href);break;case"animationend":document.documentElement.scrollTop=0,document.body.scrollTop=0,this.nextStoryDiv.removeEventListener("animationend",this),this.storyContainer.removeChild(this.currentStoryDiv),this.nextStoryDiv.classList.remove("site-main--entering"),this.bodyEl.classList.remove("page-is-transitioning"),this.updateStickyNav(),this.init(),this.runScripts(),this.dispatchEvent("afterTransitionNextStory")}}},{key:"getNextStory",value:function(e){return new Promise(function(t,i){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="document",r.onload=function(){return 200===r.status?t(r.response):i(Error(r.statusText))},r.onerror=function(e){return i(console.error("Error",e))},r.send()})}},{key:"createNextStoryEl",value:function(e){var t=e.querySelector("#main");this.nextStoryDiv=document.createElement("main"),this.nextStoryDiv.addEventListener("animationend",this),this.nextStoryDiv.innerHTML=t.innerHTML,this.nextStoryDiv.id="main"}},{key:"transitionCurrentStory",value:function(e){var t=e.querySelector("#wpadminbar"),i=e.getElementsByTagName("title");i=i[0].innerText;var r=e.body.classList;this.createNextStoryEl(e),this.currentStoryDiv.classList.add("site-main--exiting"),this.storyContainer.appendChild(this.nextStoryDiv),this.nextStoryDiv.classList.add("site-main","site-main--entering"),r.add("page-is-transitioning"),this.bodyEl.classList=r,this.currentWPAdminBar&&t&&(this.currentWPAdminBar.innerHTML=t.innerHTML),this.updateBrowserHistory(),this.updateGTMdataLayer()}},{key:"dispatchEvent",value:function(e){var t=new Event("gz.nextStory."+e);this.el.dispatchEvent(t)}},{key:"updateBrowserHistory",value:function(){history.pushState(null,this.nextStoryDocument.title,this.nextStoryTease.href),document.title=this.nextStoryDocument.title}},{key:"updateStickyNav",value:function(){this.bodyEl.classList.remove("article-is-scrolled");var e=document.querySelector(".article-sticky-navbar__title"),t=this.nextStoryDocument.querySelector(".article-sticky-navbar__title"),i=document.querySelector(".article-sticky-navbar__next"),r=this.nextStoryDocument.querySelector(".article-sticky-navbar__next");e.innerHTML=t.innerHTML,r?i.innerHTML=r.innerHTML:i.remove()}},{key:"updateGTMdataLayer",value:function(){var e=this.nextStoryDocument.querySelector("#dataLayerUpdate").innerHTML;if(e){var t=e.indexOf("{"),i=e.lastIndexOf("}"),r=e.substring(t,i+1);(r=JSON.parse(r)).event="virtualPageView",r.pagePath=this.nextStoryTease.pathname,r.pageTitle=this.nextStoryDocument.title,window.dataLayer=window.dataLayer||[],window.dataLayer.push(r)}}},{key:"runScripts",value:function(){var e=this,t=this.currentStoryDiv.querySelectorAll("script");if(t.length){var i=Array.from(t).map(function(t){return e.runScript.bind(e,t)});Object(r.a)(i)}}},{key:"runScript",value:function(e){return new Promise(function(t,i){var r=document.createElement("script");e.src?(r.onload=t,r.onerror=i,r.src=e.src,e.parentNode.replaceChild(r,e)):(r.text=e.textContent,e.parentNode.replaceChild(r,e),t())})}}]),e}();t.a=s},83:function(e,t,i){"use strict";t.a=function(e){return e.reduce(function(e,t){return e.then(function(e){return t(e)})},Promise.resolve())}},84:function(e,t,i){"use strict";var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t||document.body,this.handleContainerClick=this.handleContainerClick.bind(this),this.handleKeyup=this.handleKeyup.bind(this),this.handleViewerClick=this.handleViewerClick.bind(this),this.init()}return r(e,[{key:"init",value:function(){this.loadSourceImages(),this.hasSourceImages()&&(this.createViewer(),this.addEventListeners())}},{key:"deinit",value:function(){this.hasSourceImages()&&(this.removeEventListeners(),this.removeViewer())}},{key:"reinit",value:function(){this.deinit(),this.init()}},{key:"loadSourceImages",value:function(){this.sourceImages=document.querySelectorAll("[data-photo-viewer-src]:not(.no-photo-viewer)"),this.sourceImages=Array.prototype.slice.call(this.sourceImages),this.sourceImages.forEach(function(e){null!==e.closest("a")&&e.classList.add("no-photo-viewer")}),this.sourceImages=this.sourceImages.filter(function(e){return!e.classList.contains("no-photo-viewer")})}},{key:"createViewer",value:function(){var e=this,t=document.createElement("div");t.innerHTML='\n<div class="gz-photo-viewer">\n\t<div class="gz-photo-viewer__content">\n\t\t<div class="gz-photo-viewer__figures">\n\t\t</div>\n\t\t<div class="gz-photo-viewer__controls">\n\t\t\t<p class="gz-photo-viewer__arrows">\n\t\t\t\t<a class="gz-photo-viewer__arrows-link gz-photo-viewer__arrows-link--prev" href="#">←</a>\n\t\t\t\t<a class="gz-photo-viewer__arrows-link gz-photo-viewer__arrows-link--next" href="#">→</a>\n\t\t\t</p>\n\t\t\t<p class="gz-photo-viewer__counter"></p>\n\t\t\t<div class="gz-photo-viewer__button-wrap">\n\t\t\t\t<button class="gz-photo-viewer__close">Close</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="gz-photo-viewer__curtain"></div>\n</div>\n',this.viewer=t.firstElementChild,this.viewerContent=this.viewer.querySelector(".gz-photo-viewer__content"),this.viewerFigures=this.viewer.querySelector(".gz-photo-viewer__figures"),this.viewerCounter=this.viewer.querySelector(".gz-photo-viewer__counter"),this.viewerControls=this.viewer.querySelector(".gz-photo-viewer__controls"),this.viewerPrevBtn=this.viewer.querySelector(".gz-photo-viewer__arrows-link--prev"),this.viewerNextBtn=this.viewer.querySelector(".gz-photo-viewer__arrows-link--next"),this.viewerCloseBtn=this.viewer.querySelector(".gz-photo-viewer__close"),this.sourceImages.forEach(function(t){e.viewerFigures.appendChild(e.createFigure(t))}),this.viewer.classList.add("gz-photo-viewer--count-"+this.getTotalCount()),this.container.appendChild(this.viewer),this.container.classList.add("has-photo-viewer")}},{key:"removeViewer",value:function(){this.viewer&&(this.container.removeChild(this.viewer),this.container.classList.remove("has-photo-viewer"),this.viewer=null,this.viewerContent=null,this.viewerFigures=null,this.viewerCounter=null,this.viewerControls=null,this.viewerPrevBtn=null,this.viewerNextBtn=null,this.viewerCloseBtn=null)}},{key:"createFigure",value:function(e){var t=document.createElement("div");t.innerHTML='\n<figure class="gz-photo-viewer__figure">\n\t<div class="gz-photo-viewer__image-wrap">\n\t\t<img class="gz-photo-viewer__image" alt="">\n\t</div>\n\t<figcaption class="gz-photo-viewer__caption">\n\t\t<p class="gz-photo-viewer__caption-text"></p>\n\t</figcaption>\n</figure>\n',t=t.firstElementChild;var i=e.dataset.photoViewerSrc,r=e.dataset.photoViewerSrcset,n=e.dataset.photoViewerSizes,s=(e.dataset.photoViewerAspectRatio,e.dataset.photoViewerCaption),o=e.dataset.photoViewerWidth,a=e.dataset.photoViewerHeight,c=t.querySelector(".gz-photo-viewer__image-wrap");o&&(c.style.maxWidth=o+"px"),a&&(c.style.maxHeight=a+"px");var u=t.querySelector(".gz-photo-viewer__image");u.dataset.src=i,r&&(u.dataset.srcset=r),n&&(u.sizes=n);var h=t.querySelector(".gz-photo-viewer__caption-text");return s&&(h.innerText=s),t}},{key:"addEventListeners",value:function(){this.container.addEventListener("click",this.handleContainerClick),this.container.addEventListener("keyup",this.handleKeyup),this.viewer.addEventListener("click",this.handleViewerClick)}},{key:"removeEventListeners",value:function(){this.container.removeEventListener("click",this.handleContainerClick),this.container.removeEventListener("keyup",this.handleKeyup),this.viewer.removeEventListener("click",this.handleViewerClick)}},{key:"setCurrentFigure",value:function(e){var t=this.getFigureAt(e),i=this.currentFigure;this.currentFigure=t;var r=new Promise(function(e){i?(i.addEventListener("transitionend",function t(){this.classList.remove("leaving"),this.removeEventListener("transitionend",t),e()}),i.classList.remove("active"),i.classList.add("leaving")):e()}),n=new Promise(function(e){t.addEventListener("transitionend",function t(){this.classList.remove("entering"),this.removeEventListener("transitionend",t),e()}),t.classList.add("active"),t.classList.add("entering")});return this.viewerCounter.innerText=this.getCurrentCount()+" / "+this.getTotalCount(),this.prefetchAdjacentFigures(this.currentIndex),Promise.all([r,n])}},{key:"resetCurrentFigure",value:function(){this.currentFigure.classList.remove("active"),this.currentFigure=null}},{key:"prefetchAdjacentFigures",value:function(e){e>0&&this.prefetchFigureAt(e-1),e<this.getTotalCount()-1&&this.prefetchFigureAt(e+1)}},{key:"prefetchFigureAt",value:function(e){var t=this.getFigureAt(e);if(t&&!t.classList.contains("gz-photo-viewer__figure--loading")){var i=t.querySelector(".gz-photo-viewer__image");i&&!i.src&&(t.classList.add("gz-photo-viewer__figure--loading"),i.addEventListener("load",function e(){t.classList.remove("gz-photo-viewer__figure--loading"),t.classList.add("gz-photo-viewer__figure--loaded"),this.removeEventListener("load",e)}),i.addEventListener("error",function e(){t.classList.remove("gz-photo-viewer__figure--loading"),t.classList.add("gz-photo-viewer__figure--error"),this.removeEventListener("error",e)}),t.classList.add("gz-photo-viewer__figure--loading"),i.src=i.dataset.src,i.dataset.srcset&&(i.srcset=i.dataset.srcset))}}},{key:"open",value:function(e){this.isOpen=!0,this.currentIndex=e,this.viewer.classList.add("gz-photo-viewer--open"),this.prefetchFigureAt(e),this.setCurrentFigure(e)}},{key:"close",value:function(){this.isOpen=!1,this.currentIndex=-1,this.viewer.classList.remove("gz-photo-viewer--open"),this.resetCurrentFigure()}},{key:"next",value:function(){var e=this.currentIndex+1;e<this.getTotalCount()&&(this.currentIndex=e,this.setCurrentFigure(e))}},{key:"previous",value:function(){var e=this.currentIndex-1;0<=e&&(this.currentIndex=e,this.setCurrentFigure(e))}},{key:"hasSourceImages",value:function(){return this.sourceImages.length>0}},{key:"getSourceImageIndex",value:function(e){return this.sourceImages.indexOf(e)}},{key:"getFigureAt",value:function(e){return this.viewer.querySelectorAll(".gz-photo-viewer__figure").item(e)}},{key:"getCurrentCount",value:function(){return this.currentIndex+1}},{key:"getTotalCount",value:function(){return this.sourceImages.length}},{key:"handleContainerClick",value:function(e){var t=e.target,i=this.getSourceImageIndex(t);0<=i&&this.open(i)}},{key:"handleKeyup",value:function(e){if(this.isOpen)switch(e.key){case"ArrowLeft":case"Left":this.previous();break;case"ArrowRight":case"Right":this.next();break;case"Escape":case"Esc":this.close()}}},{key:"handleViewerClick",value:function(e){switch(e.preventDefault(),e.target){case this.viewer.querySelector(".active .gz-photo-viewer__image"):case this.viewerNextBtn:this.next();break;case this.viewerPrevBtn:this.previous();break;case this.viewerCloseBtn:default:this.close()}}}]),e}();t.a=n}});
//# sourceMappingURL=gzArticle.3d29ef608ba1b55142db.min.js.map